---
title: "服务器硬件组成和软件控制方法"
date: 2022-07-30T20:11:02+08:00
draft: true
categories: ["development"]
tags: ["x86", "server","linux"]
---



### 服务器硬件开发的特点

任何服务器的高效稳定运行，都离不开对连接到CPU的外围硬件的有效管理。就好比我们组装电脑的时候，都会优先选择华硕，微星和技嘉的主板，因为他们的主板BIOS的可配置项目非常多，也提供许多辅助超频的功能。x86服务器硬件的功能也是这样，除了整体硬件（CPU，内存和网卡）的匹配保证CPU的性能的释放，也要保证设备有一定的扩展性（特殊加速卡，加密卡，网卡的支持），较高的稳定行（电压和温度，风扇转速的监控，网口bypass和设备指示灯的控制）以及良好的互操作性能（硬件上主要是BMC的支持）。相对于嵌入式开发而言，服务器功能对于硬件的依赖程度相对较低。一是服务器各种行为只会用到CPU的通用计算能力，而嵌入式设备通常要和同环境交互，应对各类媒体计算和信号处理的功能，通常还有低功耗和无线通信的要求，所以CPU演变成了SoC，二是桌面处理器领域一直以来都是intel一家独大的局面，所有围绕桌面CPU的外围硬件也都只能按照intel的规矩来，使用相同的通信和控制方法。三是服务器的硬件功能的迭代要比嵌入式设备慢得多，每一代产品的变化主要是CPU性能和总线吞吐的提升，同步代产品的多个规格又仅在性能高低上有所区别。所以相对于嵌入式面向不同工作场景的功能定制需求，基于intel生态的服务器开发具有面向统一协议和接口，面向高性能以及虚拟化的特点。

### x86服务器硬件组成

> 依托国内的信创政策导向， 有许多国产的非x86架构服务器（华为鲲鹏，飞腾，龙芯）也占据了一部分的市场。但是为了兼容现有的x86软件生态，硬件组成上也非常相似

和大多数嵌入式数码产品一样，虽然服务器也在向着高度集成化的方向发展，但是也要考虑一定的扩展性。最基本的，至少具备扩展内存和外存的能力。我们都知道内存是直接与CPU通信的，但是各式各样的外存使用的不同的协议（SATA，NVME， SAS），他们是怎样和CPU通信的呢。按照intel制定的规矩，x86上所有的高速硬件控制器都应该通过PCIE接口与CPU通信，以获取最大的带宽和控制到最小的延迟。所以几乎所有的服务器都提供了PCIE接口，用于连接网卡，外存控制器，显卡或者其他加速卡。对于较为高端的服务器，从CPU无法引出足够的PCIE接口，就要借助芯片组（这玩意intel称之为PCH[Platform Controller Hub]，AMD称为FCH[Fusion Controller Hub]，就是一块面积较大的芯片），将CPU提供高带宽DMI接口分解为多个PCIE接口，并提供额外的SATA，USB，网口接口，以及其他低速接口（串口，SPI，I2C等）和系统管理相关的功能。


![How does cpu communicate with peripherals? - Stack Overflow] https://stackoverflow.com/questions/6852332/how-does-cpu-communicate-with-peripherals